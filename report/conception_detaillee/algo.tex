\begin{algorithme}
    \fonction{compresser}{nom:\chaine}{\naturel}{}{erreur:\naturel,stats:Statistiques$<$Octet$>$,arbre:ArbreDeHuffman$<$Octet$>$}%
    {
        \affecter{stats,erreur}{calculerStatistiques(nom)}
        \affecter{arbre}{creerArbre(stats)}
        \affecter{table}{codage(table)}
        \affecter{erreur}{erreur+compresserFichier(source,table,stats)}
        \retourner{erreur}
    }
    \fonction{calculerStatistiques}{nom:\chaine}{Statistiques$<$Octet$>$}{}{fichier:FichierBinaire,stats:Statistiques$<$Octet$>$}%
    {
        \affecter{fichier}{fichierBinaire(nom)}  
        \instruction{ouvrir(fichier,lecture)}
        \affecter{stats}{statistiques()}
        \tantque{non finFichier(fichier)}%
        {
            \instruction{incrementerOccurenceElement(stats,lireOctet(fichier))}
        }
        \instruction{fermer(fichier)}
        \retourner{stats,erreur}
    }

    \fonction{creerArbre}{stats:Statistiques$<$Octet$>$}{ArbreDeHuffman$<$Octet$>$}{}{i:\naturel , file:FileDePriorité$<$ArbreDeHuffmann$>$}
    {
        \affecter{file}{fileDePrioriteVide()}
        \pour{i}{0}{255}{}
        {
            \sialorssinon{obtenirOccurenceElement(octet(i))$\ne$0}
            {
                \instruction{ajouterElement(file,arbreDeHuffmann(octet(i),obtenirOccurenceElement(octet(i))))}
            }{}
        }
        \tantque{longueur(file)$>$1}
        {
            \affecter{arbreGauche}{obtenirDernier(file)}
            \instruction{supprimerDernier(file)}
            \affecter{arbreDroit}{obtenirDernier(file)}
            \instruction{supprimerDernier(file)}
            \instruction{ajouterElement(file,combiner(arbreGauche,arbreDroit))}
        }
        \retourner{obtenirDernier(file)}
    }  

    \fonction{codage}{arbre:ArbreDeHuffman$<$Octet$>$}{TableDeCodage$<$Octet$>$}{}{table:TableDeCodage$<$Octet$>$}%
    {
        \affecter{table}{tableDeCodage()}
        \sialorssinon{estUneFeuille(arbre)}%
        {
            \instruction{ajouterElement(table,obtenirElement(arbre))}
            \instruction{assignerCodeElement(table,obtenirElement(arbre),codeBinaire(Bit0))}
        }%
        {
            \instruction{descendreArbre(obtenirArbreDroit(arbre),codeBinaire(Bit1),table)}
            \instruction{descendreArbre(obtenirArbreGauche(arbre),codeBinaire(Bit0),table)}
        }
        \retourner{table}
    }
    \procedure{descendreArbre}{\paramEntree{arbre:ArbreDeHuffman$<$Octet$>$,code:CodeBinaire},\paramEntreeSortie{table:TableDeCodage$<$Octet$>$}}{}{codeTemp:codeBinaire}%
    {
        \sialorssinon{estUneFeuille(arbre)}%
        {
            \instruction{ajouterElement(table,obtenirElement(arbre))}
            \instruction{assignerCodeElement(table,obtenirElement(arbre),code)}
        }%
        {
            \affecter{codeTemp}{code}
            \instruction{ajouterBit(code,Bit1)}
            \instruction{ajouterBit(codeTemp,Bit0)}
            \instruction{descendreArbre(obtenirArbreDroit(arbre),code,table)}
            \instruction{descendreArbre(obtenirArbreGauche(arbre),codeTemp,table)}
        }
    }
    \procedure{compresserFichier}{\paramEntree{nom:\chaine,table:tableDeCodage$<$Octet$>$,stats:Statistiques$<$Octets$>$}}{}{}%
    {
        \affecter{fichierSource}{fichierBinaire(nom)}
        \instruction{tronquer(nom)}
        \affecter{fichierDestination}{fichierBinaire(nom + ".zip")}  
        \instruction{ouvrir(fichierSource,lecture)}
        \instruction{ouvrir(fichierDestination,écriture)}
        \instruction{ecrireNaturel(fichierDestination,CLE)}
        \instruction{ecrireNaturel(fichierDestination,nbElement(stats))}
        \pour{i}{0}{255}{}
        {
            \instruction{ecrireOctet(fichierDestination,octet(i))}
            \instruction{ecrireNaturel(fichierDestination,obtenirOccurenceElement(octet(i)))}
        }
        \tantque{non finFichier(fichierSource)}%
        {
            \instruction{ecrireCodeBinaire(fichierDestination,obtenirCodeElement(table,lireOctet(fichierSource)))}
        }
        \instruction{fermer(fichierSource)}
        \instruction{fermer(fichierDestination)}
    }
    \procedure{ecrireCodeBinaire}{\paramEntreeSortie{fichier:FichierBinaire},\paramEntree{codeBinaire:CodeBinaire}}{estOuvert(fichier),mode(fichier)=écriture}{}
    {
        \pour{i}{1}{obtenirLongueur(codeBinaire)}{}
        {
            \sialorssinon{obtenirIemeBit(codeBinaire)=Bit0}
            {
                \instruction{ecrireCaractere(fichier,'0')}
            }
            {
                \instruction{ecrireCaractere(fichier,'1')}
            }
        }
    }

\end{algorithme}
